{% extends 'base.html' %}

{% block body %}
    <h1 class="text-center mt-5">Diet</h1>
    <div class="container p-0">
        <div class="row pb-1">
            <div class="col-md-12 h6" >
                <a href="{% url 'meal_form' %}"><button class="btn btn-success text-light" type="submit">Record New Meal</button></a>
                <h6 class="d-inline btn justify-content-end bg-light">Today's Calories: {{ total }}</h6>
            </div>
        </div>
        <div class="row pb-1">
            <div class="col-md-12 h6" >
                {% if CDtable%}
                    <a href="{% url 'update_diet_form' %}"><button class="btn btn-info text-light" type="submit">Update Dietician</button></a>
                    <h6 class="d-inline btn justify-content-end bg-light">
                        {% for diet in CDtable %}
                        Your dietician is <b>{{ diet.dieter }}</b>
                        {% endfor %}
                    </h6>
                {% else %}
                    <a href="{% url 'request_dietician' %}"><button class="btn btn-info text-light" type="submit">Request Dietician</button></a>
                {% endif %}
            </div>
        </div>

        {% for meal in meal %}
            <div class="card">
              <div class="card-header">
                  <h4>{{ meal.meal_name }}</h4>
              </div>
              <div class="card-body">
                  <h5>Meal Information</h5>
                <p class="card-text">
                    <li style="list-style-type: none"><strong>Date:</strong> {{ meal.created_at }}</li>
                    <li style="list-style-type: none"><strong>Meal Type:</strong> {{ meal.meal_type }}</li>
                    <li style="list-style-type: none"><strong>Calories:</strong> {{ meal.calories }}</li>
                    <li style="list-style-type: none"><strong>Carbs:</strong> {{ meal.carbs }}</li>
                    <li style="list-style-type: none"><strong>Sugars:</strong> {{ meal.sugars }}</li>
                    <li style="list-style-type: none"><strong>Protein:</strong> {{ meal.protein }}</li>
                </p>
                  <a href="{% url 'edit_meal' meal.id %}">
                      <button class="btn btn-warning text-light">Edit</button>
                  </a>
                  <a href="{% url 'delete_meal' meal.id %}">
                      <button class="btn btn-danger text-light">Delete</button>
                  </a>
              </div>
                <br><br>
        {% endfor %}

    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script type="text/javascript">
      google.charts.load('current', {'packages':['corechart']});
      google.charts.setOnLoadCallback(drawChart);

      function drawChart() {

        var data = google.visualization.arrayToDataTable([
          ['Task', 'My Food Summary'],
          ['Carbs',      2],
          ['Sugars',  2],
          ['Protein', 2],
        ]);

        var options = {
          title: 'My Food Summary'
        };

        var chart = new google.visualization.PieChart(document.getElementById('piechart'));

        chart.draw(data, options);
      }
    </script>
     <div id="piechart" style="width: 900px; height: 500px; padding: 25px;"></div>
</div>

{% endblock %}
